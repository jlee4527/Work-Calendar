<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Work Schedule Calendar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Firebase CDN Scripts (Modular, for use in <script type="module">) -->
  <!-- You don't need compat scripts if you use type="module" -->
  <!-- If you want to use the compat version, use the compat CDN scripts and remove type="module" -->

  <!-- Your CSS file -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Work Schedule Calendar</h1>
  <!-- Add your HTML calendar, controls, etc. here as before -->

  <!-- Firebase and App Script -->
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
    import { getDatabase, ref, set, get, onValue, update, remove } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-database.js";
    // If you want analytics, you can import it, but it's optional:
    // import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-analytics.js";

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyC2aNB8y5MZcjwx8gvd813FY5Pmoc5LRus",
      authDomain: "work-schedule-3a20a.firebaseapp.com",
      databaseURL: "https://work-schedule-3a20a-default-rtdb.firebaseio.com",
      projectId: "work-schedule-3a20a",
      storageBucket: "work-schedule-3a20a.appspot.com",
      messagingSenderId: "582962494913",
      appId: "1:582962494913:web:aa37bec88da24fdc234340",
      measurementId: "G-YPZ01LW7KT"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // --- Example: How to Save and Load Data from Firebase Realtime Database ---

    // Save users array
    function saveUsers(users) {
      set(ref(db, "users"), users);
    }

    // Save availability object
    function saveAvail(avail) {
      set(ref(db, "availability"), avail);
    }

    // Listen for users and availability changes (real-time)
    function listenForUpdates(onUsers, onAvail) {
      onValue(ref(db, "users"), (snapshot) => {
        onUsers(snapshot.val() || []);
      });
      onValue(ref(db, "availability"), (snapshot) => {
        onAvail(snapshot.val() || {});
      });
    }

    // Example usage in your app:
    let users = [];
    let avail = {};

    // Update UI when users or availability changes
    function updateUsers(newUsers) {
      users = newUsers;
      // renderUserSelect();
      // renderCalendar();
      console.log("Updated users:", users);
    }

    function updateAvail(newAvail) {
      avail = newAvail;
      // renderCalendar();
      console.log("Updated availability:", avail);
    }

    listenForUpdates(updateUsers, updateAvail);

    // Example: Add a user
    function addUser(name) {
      if (!name || users.includes(name)) return;
      const updatedUsers = [...users, name];
      saveUsers(updatedUsers);
    }

    // Example: Remove a user
    function removeUser(name) {
      const updatedUsers = users.filter(u => u !== name);
      // Remove their availability as well
      const updatedAvail = Object.fromEntries(
        Object.entries(avail).filter(([key]) => !key.endsWith(`|${name}`))
      );
      saveUsers(updatedUsers);
      saveAvail(updatedAvail);
    }

    // Example: Toggle a day's availability for a user
    function toggleAvailability(date, name) {
      const key = `${date}|${name}`;
      const updatedAvail = { ...avail };
      updatedAvail[key] = !updatedAvail[key];
      saveAvail(updatedAvail);
    }

    // ---- Connect these to your UI (buttons, calendar cells, etc.) ----

    // Example: To add a user from a form/input
    // document.getElementById("add-btn").onclick = () => {
    //   addUser(document.getElementById("name-input").value);
    // };

    // Example: To toggle availability from a calendar click
    // calendarCell.onclick = () => {
    //   const date = "2025-07-31"; // set this dynamically
    //   const name = "Alice"; // set this dynamically
    //   toggleAvailability(date, name);
    // };

  </script>
</body>
</html>
